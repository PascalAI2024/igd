import{r as e}from"./react-vendor-9ae03318.js";import{j as t}from"./index-1485ed2e.js";const r=()=>{const e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),t=!!navigator.getBattery;return{targetFPS:e?30:60,batterySaver:e&&t}};class s{constructor(e){var t;this.frameId=null,this.lastTime=0,this.fps=60,this.isPaused=!1,this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps,this.onPauseChange=e.onPauseChange,e.batterySaver&&navigator.getBattery&&(null==(t=navigator.getBattery)||t.call(navigator).then((t=>{const r=()=>{t.level<=.2&&!t.charging?(this.fps=30,this.fpsInterval=1e3/this.fps):(this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps)};t.addEventListener("levelchange",r),t.addEventListener("chargingchange",r)})).catch((()=>{this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps}))),document.addEventListener("visibilitychange",(()=>{document.hidden?this.pause():this.resume()}))}start(e){let t,r=performance.now();const s=n=>{this.isPaused||(this.frameId=requestAnimationFrame(s),t=n-r,t>this.fpsInterval&&(r=n-t%this.fpsInterval,e(t)))};return this.frameId=requestAnimationFrame(s),()=>{null!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null)}}pause(){var e;this.isPaused||(this.isPaused=!0,null==(e=this.onPauseChange)||e.call(this,!0))}resume(){var e;this.isPaused&&(this.isPaused=!1,null==(e=this.onPauseChange)||e.call(this,!1),this.lastTime=performance.now())}getFPS(){return this.fps}}function n(t,n={}){const{autoStart:a=!0,showError:i=!0,onError:o,...u}=n,l=e.useRef(null),c=e.useRef(null),[h,d]=e.useState(60),[f,p]=e.useState(!1),[m,v]=e.useState(!1),[g,P]=e.useState(null),w="undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame&&"function"==typeof window.cancelAnimationFrame&&"object"==typeof window.performance&&"function"==typeof window.performance.now;e.useEffect((()=>{if(!w){const e=new Error("Canvas animation not supported in this browser");return P(e),void(i&&(null==o||o(e)))}const e={...r(),...u,onPauseChange:e=>{var t;v(e),null==(t=n.onPauseChange)||t.call(n,e)}};return c.current=new s(e),a&&E(),()=>{S()}}),[w,a]),e.useEffect((()=>{if(!c.current||!f)return;const e=setInterval((()=>{var e;d((null==(e=c.current)?void 0:e.getFPS())||0)}),1e3);return()=>clearInterval(e)}),[f]);const E=e.useCallback((()=>{if(c.current&&l.current)try{const e=c.current.start(t);return p(!0),P(null),e}catch(e){const t=e instanceof Error?e:new Error("Failed to start animation");P(t),p(!1),i&&(null==o||o(t))}}),[t,i,o]),S=e.useCallback((()=>{var e;null==(e=c.current)||e.start((()=>{}))(),p(!1),v(!1)}),[]),b=e.useCallback((()=>{var e;null==(e=c.current)||e.pause()}),[]),y=e.useCallback((()=>{var e;null==(e=c.current)||e.resume()}),[]);return{canvasRef:l,start:E,stop:S,pause:b,resume:y,fps:h,isSupported:w,isRunning:f,isPaused:m,error:g}}class a extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){var e;return this.state.hasError?this.props.fallback||t.jsxs("div",{className:"bg-red-500/10 rounded-lg p-4 text-red-500",children:[t.jsx("p",{className:"font-bold",children:"Animation Error"}),t.jsx("p",{className:"text-sm",children:null==(e=this.state.error)?void 0:e.message}),t.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"mt-4 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"Try Again"})]}):this.props.children}}export{a as A,n as u};
