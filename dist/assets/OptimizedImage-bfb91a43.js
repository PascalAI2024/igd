import{j as e}from"./index-7cf7c2b5.js";import{r}from"./react-vendor-9ae03318.js";import{az as t}from"./ui-vendor-620d5505.js";const a=({src:a,alt:o,className:s="",width:l,height:n,fallbackIcon:i=e.jsx(t,{className:"w-8 h-8 text-red-500/70"}),fallbackClassName:c="flex items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800",onLoad:u,onError:g,priority:m=!1,objectFit:d="cover"})=>{const[f,h]=r.useState(!0),[$,x]=r.useState(!1),[y,j]=r.useState(null),b=r.useRef(null),p=r.useRef(0);return r.useEffect((()=>{h(!0),x(!1),p.current=0;const e=()=>{const r=new Image,t=a.includes("?")?a:`${a}?t=${Date.now()}`;r.src=t,m&&(r.fetchPriority="high"),r.onload=()=>{j(a),h(!1),null==u||u()},r.onerror=()=>{p.current<2?(p.current+=1,setTimeout(e,1e3)):(h(!1),x(!0),null==g||g())}};return e(),()=>{b.current&&(b.current.onload=null,b.current.onerror=null)}}),[a,u,g,m]),$?e.jsx("div",{className:`${c} ${s}`,style:{width:l?`${l}px`:"100%",height:n?`${n}px`:"100%"},role:"img","aria-label":`${o} (image failed to load)`,children:i}):f?e.jsx("div",{className:`animate-pulse bg-gradient-to-br from-gray-800 to-gray-900 ${s}`,style:{width:l?`${l}px`:"100%",height:n?`${n}px`:"100%"},role:"img","aria-label":`Loading ${o}`}):e.jsx("img",{ref:b,src:y||"",alt:o,className:s,width:l,height:n,loading:m?"eager":"lazy",style:{objectFit:d},onError:e=>{if(p.current<2){p.current+=1;const r=e.target,t=`${a}?retry=${p.current}&t=${Date.now()}`;r.src=t}else x(!0),null==g||g()}})};export{a as O};
