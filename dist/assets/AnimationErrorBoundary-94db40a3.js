var e=Object.defineProperty,t=(t,r,s)=>(((t,r,s)=>{r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s})(t,"symbol"!=typeof r?r+"":r,s),s);import{r}from"./react-vendor-9ae03318.js";import{j as s}from"./index-7cf7c2b5.js";const n=()=>{const e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),t=!!navigator.getBattery;return{targetFPS:e?30:60,batterySaver:e&&t}};class a{constructor(e){var r;t(this,"frameId",null),t(this,"lastTime",0),t(this,"fps",60),t(this,"fpsInterval"),t(this,"isPaused",!1),t(this,"onPauseChange"),this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps,this.onPauseChange=e.onPauseChange,e.batterySaver&&navigator.getBattery&&(null==(r=navigator.getBattery)||r.call(navigator).then((t=>{const r=()=>{t.level<=.2&&!t.charging?(this.fps=30,this.fpsInterval=1e3/this.fps):(this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps)};t.addEventListener("levelchange",r),t.addEventListener("chargingchange",r)})).catch((()=>{this.fps=e.targetFPS||60,this.fpsInterval=1e3/this.fps}))),document.addEventListener("visibilitychange",(()=>{document.hidden?this.pause():this.resume()}))}start(e){let t,r=performance.now(),s=0,n=r,a=this.fps;const i=o=>{this.isPaused||(s++,o-n>=1e3&&(a=s,this.fps=a,s=0,n=o),this.frameId=requestAnimationFrame(i),t=Math.min(o-r,100),t>this.fpsInterval&&(r=o-t%this.fpsInterval,e(t)))};return this.frameId=requestAnimationFrame(i),()=>{null!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null)}}pause(){var e;this.isPaused||(this.isPaused=!0,null==(e=this.onPauseChange)||e.call(this,!0))}resume(){var e;this.isPaused&&(this.isPaused=!1,null==(e=this.onPauseChange)||e.call(this,!1),this.lastTime=performance.now())}getFPS(){return this.fps}}function i(e,t={}){const{autoStart:s=!0,showError:i=!0,onError:o,...u}=t,l=r.useRef(null),c=r.useRef(null),[h,d]=r.useState(60),[f,p]=r.useState(!1),[m,v]=r.useState(!1),[g,P]=r.useState(null),b="undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame&&"function"==typeof window.cancelAnimationFrame&&"object"==typeof window.performance&&"function"==typeof window.performance.now;r.useEffect((()=>{if(!b){const e=new Error("Canvas animation not supported in this browser");return P(e),void(i&&(null==o||o(e)))}const e={...n(),...u,onPauseChange:e=>{var r;v(e),null==(r=t.onPauseChange)||r.call(t,e)}};return c.current=new a(e),s&&w(),()=>{y()}}),[b,s]),r.useEffect((()=>{if(!c.current||!f)return;const e=setInterval((()=>{var e;d((null==(e=c.current)?void 0:e.getFPS())||0)}),1e3);return()=>clearInterval(e)}),[f]);const w=r.useCallback((()=>{if(c.current&&l.current)try{const t=c.current.start(e);return p(!0),P(null),t}catch(t){const e=t instanceof Error?t:new Error("Failed to start animation");P(e),p(!1),i&&(null==o||o(e))}}),[e,i,o]),y=r.useCallback((()=>{var e;null==(e=c.current)||e.start((()=>{}))(),p(!1),v(!1)}),[]),S=r.useCallback((()=>{var e;null==(e=c.current)||e.pause()}),[]),E=r.useCallback((()=>{var e;null==(e=c.current)||e.resume()}),[]);return{canvasRef:l,start:w,stop:y,pause:S,resume:E,fps:h,isSupported:b,isRunning:f,isPaused:m,error:g}}function o(e,t={}){return i(e,{...t,targetFPS:60,batterySaver:!1})}class u extends r.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){var e;return this.state.hasError?this.props.fallback||s.jsxs("div",{className:"bg-red-500/10 rounded-lg p-4 text-red-500",children:[s.jsx("p",{className:"font-bold",children:"Animation Error"}),s.jsx("p",{className:"text-sm",children:null==(e=this.state.error)?void 0:e.message}),s.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"mt-4 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"Try Again"})]}):this.props.children}}export{u as A,o as a,i as u};
